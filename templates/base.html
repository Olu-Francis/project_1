<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>{% block title %}{% endblock %}</title>

        <!-- CSS FILES -->
        <link rel="preconnect" href="https://fonts.googleapis.com">

        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

        <link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@300;400;700&display=swap" rel="stylesheet">

        <link href="{{ url_for('static', filename='css/bootstrap.min.css') }}" rel="stylesheet">

        <link href="{{ url_for('static', filename='css/bootstrap-icons.css') }}" rel="stylesheet">

        <link href="{{ url_for('static', filename='css/apexcharts.css') }}" rel="stylesheet">

        <link href="{{ url_for('static', filename='css/tooplate-mini-finance.css') }}" rel="stylesheet">


    </head>

    <body>
        {% include 'navbar.html' %}

        <div class="container-fluid">
            <div class="row">
                {% include 'side_bar.html' %}

        {% block content %}
        {% endblock %}


        {% include 'footer.html' %}

        <script type="text/javascript">
            let pie_option = {
                series: [{{ balance }}, {{ expense_data|sum }}, {{ income_data|sum }}],
                chart: {
                    width: 380,
                    type: 'pie',
                },
                labels: ['Balance', 'Expense', 'Income'],
                responsive: [{
                    breakpoint: 480,
                    options: {
                        chart: {
                            width: 200
                        },
                        legend: {
                            position: 'bottom'
                        }
                    }
                }]
            };

            let pie_chart = new ApexCharts(document.querySelector("#pie-chart"), pie_option);
            pie_chart.render();
        </script>

        {% if income_data %}
        <script type="text/javascript">
            let graph_option = {
                series: [{
                    name: 'Income',
                    data: {{ income_data | tojson }}
                }, {
                    name: 'Expense',
                    data: {{ expense_data | tojson }}
                }],
                chart: {
                    type: 'bar',
                    height: 350
                },
                plotOptions: {
                    bar: {
                        horizontal: false,
                        columnWidth: '55%',
                        endingShape: 'rounded'
                    },
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    show: true,
                    width: 2,
                    colors: ['transparent']
                },
                xaxis: {
                    categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                },
                yaxis: {
                    title: {
                        text: '$ (thousands)'
                    }
                },
                fill: {
                    opacity: 1
                },
                tooltip: {
                    y: {
                        formatter: function (val) {
                            return "$ " + val + " thousands"
                        }
                    }
                }
            };

            let graph_chart = new ApexCharts(document.querySelector("#chart"), graph_option);
            graph_chart.render();
        </script>
        {% endif %}

    </body>
</html>